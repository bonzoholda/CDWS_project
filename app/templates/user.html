<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check My Bills</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="form-container">
    <h1>Check Your Pending Bills</h1>
    <form action="/user" method="get">
        <label for="user_id">Enter Your User ID:</label>
        <input type="text" name="user_id" required>
        <button type="submit">Check</button>
    </form>
    </div>
        
    {% if user_data %}
        <h2>Pending Bills for {{ user_data[0].user_name }}</h2>
        <div class="table-wrapper">
        <table class="bill-table">

            <tbody>
                {% for bill in user_data %}
                <tr>
                    <td data-label="Pay Period"><span>{{ bill.pay_period }}</span></td>
                    <td data-label="Device ID"><span>{{ bill.device_id }}</span></td>
                    <td data-label="Address"><span>{{ bill.user_address }}</span></td>
                    <td data-label="Meter Past"><span>{{ bill.meter_past }}</span></td>
                    <td data-label="Meter Now"><span>{{ bill.meter_now }}</span></td>
                    <td data-label="Usage"><span>{{ bill.usage }}</span></td>
                    <td data-label="Level 1"><span>{{ bill.lv1_cost }}</span></td>
                    <td data-label="Level 2"><span>{{ bill.lv2_cost }}</span></td>
                    <td data-label="Level 3"><span>{{ bill.lv3_cost }}</span></td>
                    <td data-label="Level 4"><span>{{ bill.lv4_cost }}</span></td>
                    <td data-label="Basic Cost"><span>{{ bill.basic_cost }}</span></td>
                    <td data-label="Bill Amount"><span>{{ bill.bill_amount }}</span></td>
                </tr>
                {% endfor %}
            </tbody>

        </table>
        </div>
        <h3>Total Due: {{ user_data | map(attribute='bill_amount') | sum }}</h3>
    {% elif user_id %}
        <p>No unpaid bills found for user ID {{ user_id }}.</p>
    {% endif %}
</body>
</html>
